<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Step 9: Continuous Integration & Automated Reporting</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <!-- highlight.js CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- Shared Styles -->
    <link rel="stylesheet" href="../shared-styles.css">
</head>

<body><div class="progress-indicator"><div class="progress-bar" style="width: 100%;"></div></div>
    <!-- Header Section -->
    <div class="lesson-header">
        <div class="container">
            <div class="lesson-content">
                <div class="lesson-number-badge">9</div>
                <h1 class="lesson-title">Continuous Integration & Automated Reporting</h1>
                <p class="lesson-description">Transform our testing framework into a production-ready CI/CD pipeline with automated test execution, comprehensive reporting, and GitHub Actions integration</p>
            </div>
        </div>
    </div>

    <div class="container">
        <!-- Navigation -->
        <div class="lesson-nav">
            <ul class="nav-breadcrumb">
                <li><a href="../index.html"><i class="bi bi-house"></i> Home</a></li>
                <li><i class="bi bi-chevron-right separator"></i></li>
                <li><span style="color: var(--secondary-color);">Step 9</span></li>
            </ul>
            <div class="nav-actions">
                <a href="step8.html" class="nav-btn nav-btn-outline"><i class="bi bi-arrow-left"></i> Previous Step</a>
                <a href="https://github.com/radu-tataru/radu-tataru-qa-java-course-project-v2/tree/master/step9-ci-cd-integration" class="nav-btn nav-btn-secondary" target="_blank"><i class="bi bi-github"></i> View Code</a>
                <a href="step10.html" class="nav-btn nav-btn-primary">Next Step <i class="bi bi-arrow-right"></i></a>
            </div>
        </div>

        <!-- Learning Objectives -->
        <div class="content-section">
            <h2 class="section-title">
                <div class="section-icon"><i class="bi bi-bullseye"></i></div>
                Learning Objectives
            </h2>
            <div class="objectives-list">
                <div class="objective-item">
                    <i class="bi bi-check-circle objective-icon"></i>
                    <div>
                        <strong>GitHub Actions CI/CD</strong><br>
                        Set up automated test execution with GitHub Actions workflows
                    </div>
                </div>
                <div class="objective-item">
                    <i class="bi bi-check-circle objective-icon"></i>
                    <div>
                        <strong>Test Reporting & Analytics</strong><br>
                        Generate comprehensive HTML reports with Allure and Maven Surefire
                    </div>
                </div>
                <div class="objective-item">
                    <i class="bi bi-check-circle objective-icon"></i>
                    <div>
                        <strong>Multi-Environment Testing</strong><br>
                        Configure parallel testing across different environments and browsers
                    </div>
                </div>
                <div class="objective-item">
                    <i class="bi bi-check-circle objective-icon"></i>
                    <div>
                        <strong>Quality Gates & Notifications</strong><br>
                        Implement automated quality gates with Slack/email notifications
                    </div>
                </div>
            </div>
        </div>

        <!-- What We're Building -->
        <div class="content-section">
            <h2 class="section-title">
                <div class="section-icon"><i class="bi bi-lightbulb"></i></div>
                From Manual Testing to Automated CI/CD Pipeline
            </h2>
            <p>In this lesson, we're building a <strong>complete CI/CD pipeline</strong> that transforms our data-driven testing framework into an enterprise-grade automated testing solution. This represents the industry standard for professional QA automation:</p>
            
            <div class="alert-box alert-info">
                <i class="bi bi-info-circle alert-icon"></i>
                <div>
                    <strong>Enterprise Reality:</strong> Modern development teams rely on automated CI/CD pipelines that run thousands of tests automatically on every code change. Learning to build these pipelines makes you invaluable in any QA engineering role.
                </div>
            </div>

            <h3>The Professional Testing Lifecycle</h3>
            <div class="workflow-steps">
                <div class="workflow-item">
                    <div class="workflow-icon">üîÑ</div>
                    <div class="workflow-content">
                        <strong>Continuous Integration</strong><br>
                        Tests run automatically on every code commit, preventing regression bugs
                    </div>
                </div>
                <div class="workflow-item">
                    <div class="workflow-icon">üìä</div>
                    <div class="workflow-content">
                        <strong>Automated Reporting</strong><br>
                        Generate beautiful HTML reports with test results, screenshots, and analytics
                    </div>
                </div>
                <div class="workflow-item">
                    <div class="workflow-icon">üîî</div>
                    <div class="workflow-content">
                        <strong>Smart Notifications</strong><br>
                        Slack and email alerts when tests fail, with detailed failure analysis
                    </div>
                </div>
            </div>
        </div>

        <!-- GitHub Actions Setup -->
        <div class="content-section">
            <h2 class="section-title">
                <div class="section-icon"><i class="bi bi-gear-wide-connected"></i></div>
                GitHub Actions Workflow Configuration
            </h2>
            <p>We'll create a GitHub Actions workflow that automatically runs our test suite on every push and pull request:</p>
            
            <h3>Workflow File: <code>.github/workflows/test-automation.yml</code></h3>
            <pre><code class="language-yaml">name: Test Automation Pipeline

on:
  push:
    branches: [ main, develop ]
  pull_request:
    branches: [ main ]
  schedule:
    # Run tests daily at 2 AM UTC
    - cron: '0 2 * * *'

jobs:
  test-suite:
    runs-on: ubuntu-latest
    
    strategy:
      matrix:
        environment: [dev, staging, prod]
        browser: [chrome, firefox, edge]
    
    steps:
    - uses: actions/checkout@v4
    
    - name: Set up JDK 11
      uses: actions/setup-java@v4
      with:
        java-version: '11'
        distribution: 'temurin'
    
    - name: Cache Maven dependencies
      uses: actions/cache@v3
      with:
        path: ~/.m2
        key: ${{ runner.os }}-m2-${{ hashFiles('**/pom.xml') }}
    
    - name: Install Chrome Browser
      uses: browser-actions/setup-chrome@latest
    
    - name: Run Test Suite
      run: |
        mvn clean test -Denv=${{ matrix.environment }} -Dbrowser=${{ matrix.browser }}
      env:
        CI: true
        ENVIRONMENT: ${{ matrix.environment }}
    
    - name: Generate Allure Report
      uses: simple-elf/allure-report-action@master
      if: always()
      with:
        allure_results: target/allure-results
        allure_history: allure-history
    
    - name: Upload Test Reports
      uses: actions/upload-artifact@v3
      if: always()
      with:
        name: test-reports-${{ matrix.environment }}-${{ matrix.browser }}
        path: |
          target/surefire-reports/
          target/allure-results/
          screenshots/
    
    - name: Notify Slack on Failure
      if: failure()
      uses: 8398a7/action-slack@v3
      with:
        status: failure
        channel: '#qa-alerts'
        webhook_url: ${{ secrets.SLACK_WEBHOOK }}</code></pre>
        </div>

        <!-- Project Structure -->
        <div class="content-section">
            <h2 class="section-title">
                <div class="section-icon"><i class="bi bi-folder"></i></div>
                Project Structure
            </h2>
            <div class="alert-box alert-info">
                <i class="bi bi-info-circle alert-icon"></i>
                <div>
                    <strong>CI/CD Integration:</strong> We'll add GitHub Actions workflows, reporting configurations, and notification systems to our existing data-driven testing framework.
                </div>
            </div>
            <div class="file-structure">
                <ul class="file-tree">
                    <li><span class="folder">üìÅ java_project/</span>
                        <ul>
                            <li><span class="folder">üìÅ .github/workflows/</span>
                                <ul>
                                    <li><span class="file">üîÑ test-automation.yml (NEW)</span></li>
                                    <li><span class="file">üîÑ nightly-regression.yml (NEW)</span></li>
                                </ul>
                            </li>
                            <li><span class="folder">üìÅ src/</span>
                                <ul>
                                    <li><span class="folder">üìÅ main/java/com/example/app/</span>
                                        <ul>
                                            <li><span class="folder">üìÅ reporting/</span>
                                                <ul>
                                                    <li><span class="java-file">üìä AllureReportManager.java (NEW)</span></li>
                                                    <li><span class="java-file">üìä TestResultAnalyzer.java (NEW)</span></li>
                                                </ul>
                                            </li>
                                            <li><span class="folder">üìÅ notifications/</span>
                                                <ul>
                                                    <li><span class="java-file">üîî SlackNotifier.java (NEW)</span></li>
                                                    <li><span class="java-file">üîî EmailNotifier.java (NEW)</span></li>
                                                </ul>
                                            </li>
                                            <li><span class="folder">üìÅ pages/ (existing)</span></li>
                                            <li><span class="folder">üìÅ data/ (existing)</span></li>
                                            <li><span class="folder">üìÅ config/ (existing)</span></li>
                                            <li><span class="folder">üìÅ utils/ (existing)</span></li>
                                            <li><span class="java-file">‚òï Main.java</span></li>
                                        </ul>
                                    </li>
                                    <li><span class="folder">üìÅ test/java/com/example/app/</span>
                                        <ul>
                                            <li><span class="java-file">üß™ CITestSuite.java (NEW)</span></li>
                                            <li><span class="java-file">üß™ ParameterizedWebsiteTests.java</span></li>
                                        </ul>
                                    </li>
                                </ul>
                            </li>
                            <li><span class="folder">üìÅ test-resources/</span>
                                <ul>
                                    <li><span class="file">üìä allure.properties (NEW)</span></li>
                                    <li><span class="file">‚öôÔ∏è junit-platform.properties (NEW)</span></li>
                                </ul>
                            </li>
                            <li><span class="folder">üìÅ screenshots/ (auto-generated)</span></li>
                            <li><span class="file">üìÑ pom.xml (Updated with Allure, reporting plugins)</span></li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>

        <!-- Allure Reporting Setup -->
        <div class="content-section">
            <h2 class="section-title">
                <div class="section-icon"><i class="bi bi-file-earmark-bar-graph"></i></div>
                Advanced Test Reporting with Allure
            </h2>
            <p>Allure provides the most comprehensive test reporting available for Java projects:</p>

            <h3>Allure Report Manager</h3>
            <pre><code class="language-java">@Component
public class AllureReportManager {
    private static final Logger logger = LoggerFactory.getLogger(AllureReportManager.class);
    
    @Attachment(value = "Screenshot", type = "image/png")
    public static byte[] captureScreenshot(WebDriver driver) {
        try {
            return ((TakesScreenshot) driver).getScreenshotAs(OutputType.BYTES);
        } catch (Exception e) {
            logger.error("Failed to capture screenshot: {}", e.getMessage());
            return new byte[0];
        }
    }
    
    @Attachment(value = "Page Source", type = "text/html")
    public static String capturePageSource(WebDriver driver) {
        return driver.getPageSource();
    }
    
    @Attachment(value = "Test Data", type = "application/json")
    public static String attachTestData(Object testData) {
        ObjectMapper mapper = new ObjectMapper();
        try {
            return mapper.writerWithDefaultPrettyPrinter()
                         .writeValueAsString(testData);
        } catch (JsonProcessingException e) {
            return "Failed to serialize test data: " + e.getMessage();
        }
    }
    
    public static void addEnvironmentInfo() {
        Properties props = new Properties();
        props.setProperty("Browser", System.getProperty("browser", "chrome"));
        props.setProperty("Environment", System.getProperty("env", "dev"));
        props.setProperty("Base URL", EnvironmentConfig.getProperty("base.url"));
        props.setProperty("Test Suite", "Web Automation Suite");
        props.setProperty("Execution Date", LocalDateTime.now().toString());
        
        try (FileOutputStream fos = new FileOutputStream("target/allure-results/environment.properties")) {
            props.store(fos, "Test Environment Information");
        } catch (IOException e) {
            logger.error("Failed to create environment.properties: {}", e.getMessage());
        }
    }
}</code></pre>

            <h3>Enhanced Test with Allure Annotations</h3>
            <pre><code class="language-java">@Epic("Web Application Testing")
@Feature("Homepage Verification")
public class EnhancedWebsiteTests {
    
    @Test
    @Story("User can access GitHub homepage")
    @Severity(SeverityLevel.CRITICAL)
    @Description("Verify that GitHub homepage loads correctly and displays expected content")
    void testGitHubHomepage(WebsiteTestData testData) {
        
        AllureReportManager.attachTestData(testData);
        
        step("Navigate to GitHub homepage", () -> {
            driver.get(testData.getWebsiteUrl());
            AllureReportManager.captureScreenshot(driver);
        });
        
        step("Verify page title", () -> {
            String actualTitle = driver.getTitle();
            assertThat(actualTitle).contains(testData.getExpectedTitle());
        });
        
        step("Verify page elements are visible", () -> {
            PageObjectManager pageManager = new PageObjectManager(driver);
            BasePage page = pageManager.navigateToPage(testData.getWebsiteUrl());
            
            TestResult result = page.verifyPageElements();
            AllureReportManager.captureScreenshot(driver);
            
            if (!result.allTestsPassed()) {
                AllureReportManager.capturePageSource(driver);
                fail("Page verification failed: " + result.getFailureMessage());
            }
        });
    }
}</code></pre>
        </div>

        <!-- Required Dependencies -->
        <div class="content-section">
            <h2 class="section-title">
                <div class="section-icon"><i class="bi bi-tools"></i></div>
                Required Dependencies
            </h2>
            <p>Add these Maven dependencies to your <code>pom.xml</code>:</p>
            
            <pre><code class="language-xml">&lt;dependencies&gt;
    &lt;!-- Existing dependencies --&gt;
    
    &lt;!-- NEW: Allure Reporting Framework --&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;io.qameta.allure&lt;/groupId&gt;
        &lt;artifactId&gt;allure-junit5&lt;/artifactId&gt;
        &lt;version&gt;2.24.0&lt;/version&gt;
    &lt;/dependency&gt;
    
    &lt;dependency&gt;
        &lt;groupId&gt;io.qameta.allure&lt;/groupId&gt;
        &lt;artifactId&gt;allure-selenide&lt;/artifactId&gt;
        &lt;version&gt;2.24.0&lt;/version&gt;
    &lt;/dependency&gt;
    
    &lt;!-- NEW: Slack Notifications --&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;com.slack.api&lt;/groupId&gt;
        &lt;artifactId&gt;slack-api-client&lt;/artifactId&gt;
        &lt;version&gt;1.34.0&lt;/version&gt;
    &lt;/dependency&gt;
    
    &lt;!-- NEW: Email Notifications --&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;javax.mail&lt;/groupId&gt;
        &lt;artifactId&gt;javax.mail-api&lt;/artifactId&gt;
        &lt;version&gt;1.6.2&lt;/version&gt;
    &lt;/dependency&gt;
    
    &lt;dependency&gt;
        &lt;groupId&gt;com.sun.mail&lt;/groupId&gt;
        &lt;artifactId&gt;javax.mail&lt;/artifactId&gt;
        &lt;version&gt;1.6.2&lt;/version&gt;
    &lt;/dependency&gt;
&lt;/dependencies&gt;

&lt;build&gt;
    &lt;plugins&gt;
        &lt;!-- Existing plugins --&gt;
        
        &lt;!-- NEW: Allure Maven Plugin --&gt;
        &lt;plugin&gt;
            &lt;groupId&gt;io.qameta.allure&lt;/groupId&gt;
            &lt;artifactId&gt;allure-maven&lt;/artifactId&gt;
            &lt;version&gt;2.12.0&lt;/version&gt;
        &lt;/plugin&gt;
        
        &lt;!-- Enhanced Surefire Plugin for CI/CD --&gt;
        &lt;plugin&gt;
            &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
            &lt;artifactId&gt;maven-surefire-plugin&lt;/artifactId&gt;
            &lt;version&gt;3.2.2&lt;/version&gt;
            &lt;configuration&gt;
                &lt;properties&gt;
                    &lt;property&gt;
                        &lt;name&gt;listener&lt;/name&gt;
                        &lt;value&gt;io.qameta.allure.junit5.AllureJunit5&lt;/value&gt;
                    &lt;/property&gt;
                &lt;/properties&gt;
                &lt;systemProperties&gt;
                    &lt;allure.results.directory&gt;${project.build.directory}/allure-results&lt;/allure.results.directory&gt;
                &lt;/systemProperties&gt;
            &lt;/configuration&gt;
        &lt;/plugin&gt;
    &lt;/plugins&gt;
&lt;/build&gt;</code></pre>
        </div>

        <!-- CI/CD Best Practices -->
        <div class="content-section">
            <h2 class="section-title">
                <div class="section-icon"><i class="bi bi-shield-check"></i></div>
                CI/CD Best Practices & Quality Gates
            </h2>
            <p>Professional CI/CD pipelines implement quality gates that prevent bad code from reaching production:</p>
            
            <div class="practices-grid">
                <div class="practice-item">
                    <h4><i class="bi bi-speedometer2"></i> Performance Thresholds</h4>
                    <ul>
                        <li>Tests must complete within 15 minutes</li>
                        <li>Page load times under 3 seconds</li>
                        <li>API response times under 500ms</li>
                    </ul>
                </div>
                
                <div class="practice-item">
                    <h4><i class="bi bi-bug"></i> Quality Metrics</h4>
                    <ul>
                        <li>98%+ test pass rate required</li>
                        <li>Zero critical security vulnerabilities</li>
                        <li>Code coverage above 80%</li>
                    </ul>
                </div>
                
                <div class="practice-item">
                    <h4><i class="bi bi-arrow-clockwise"></i> Retry Strategies</h4>
                    <ul>
                        <li>Automatic retry on network timeouts</li>
                        <li>Smart screenshot capture on failures</li>
                        <li>Detailed error logging and analysis</li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="alert alert-success">
            <h4><i class="bi bi-lightbulb"></i> Professional CI/CD Insight</h4>
            <p><strong>Industry Impact:</strong> Companies like Netflix, Google, and Amazon deploy thousands of times per day using automated CI/CD pipelines. The skills you're learning here - automated testing, reporting, and deployment pipelines - are exactly what Fortune 500 companies need in their QA engineers. This knowledge directly translates to senior-level positions and significantly higher salaries.</p>
        </div>

        <!-- Key Takeaways -->
        <div class="content-section">
            <h2 class="section-title">
                <div class="section-icon"><i class="bi bi-trophy"></i></div>
                Key Takeaways
            </h2>
            <div class="takeaway-grid">
                <div class="takeaway-item">
                    <i class="bi bi-gear-wide-connected text-primary"></i>
                    <span><strong>GitHub Actions CI/CD:</strong> Automated test execution on every code change prevents regression bugs</span>
                </div>
                <div class="takeaway-item">
                    <i class="bi bi-file-earmark-bar-graph text-primary"></i>
                    <span><strong>Allure Reporting:</strong> Professional HTML reports with screenshots, analytics, and failure analysis</span>
                </div>
                <div class="takeaway-item">
                    <i class="bi bi-layers text-primary"></i>
                    <span><strong>Multi-Environment Testing:</strong> Parallel execution across different browsers and environments</span>
                </div>
                <div class="takeaway-item">
                    <i class="bi bi-shield-check text-primary"></i>
                    <span><strong>Quality Gates:</strong> Automated quality checks that maintain high standards in production</span>
                </div>
            </div>
        </div>

        <!-- Bottom Navigation -->
        <div class="lesson-nav bottom-nav">
            <div class="nav-actions">
                <a href="step8.html" class="nav-btn nav-btn-outline"><i class="bi bi-arrow-left"></i> Previous Step</a>
                <a href="https://github.com/radu-tataru/radu-tataru-qa-java-course-project-v2/tree/master/step9-ci-cd-integration" class="nav-btn nav-btn-secondary" target="_blank"><i class="bi bi-github"></i> View Code</a>
                <a href="step10.html" class="nav-btn nav-btn-primary">Next Step <i class="bi bi-arrow-right"></i></a>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script>hljs.highlightAll();</script>
</body>
</html>