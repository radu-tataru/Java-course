<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Step 9: ExtentReports Integration</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <!-- highlight.js CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- Shared Styles -->
    <link rel="stylesheet" href="../shared-styles.css">
</head>
<body>
    <!-- Header Section -->
    <div class="lesson-header">
        <div class="container">
            <div class="lesson-content">
                <div class="lesson-number-badge">9</div>
                <h1 class="lesson-title">ExtentReports Integration</h1>
                <p class="lesson-description">Enhance our Cucumber BDD framework with professional HTML reports featuring rich dashboards, screenshots, and analytics for comprehensive test documentation</p>
            </div>
        </div>
    </div>

    <div class="container">
        <!-- Navigation -->
        <div class="lesson-nav">
            <ul class="nav-breadcrumb">
                <li><a href="../index.html"><i class="bi bi-house"></i> Home</a></li>
                <li><i class="bi bi-chevron-right separator"></i></li>
                <li><span style="color: var(--secondary-color);">Step 9</span></li>
            </ul>
            <div class="nav-actions">
                <a href="step8.html" class="nav-btn nav-btn-outline"><i class="bi bi-arrow-left"></i> Step 8</a>
                <a href="https://github.com/radu-tataru/radu-tataru-qa-java-course-project-v2/tree/master/step9-extent-reports" class="nav-btn nav-btn-secondary" target="_blank"><i class="bi bi-github"></i> View Code</a>
                <a href="step10.html" class="nav-btn nav-btn-primary">Next: Step 10 <i class="bi bi-arrow-right"></i></a>
            </div>
        </div>

        <!-- Learning Objectives -->
        <div class="content-section">
            <h2 class="section-title">
                <div class="section-icon"><i class="bi bi-bullseye"></i></div>
                Learning Objectives
            </h2>
            <div class="objectives-list">
                <div class="objective-item">
                    <i class="bi bi-check-circle objective-icon"></i>
                    <div>
                        <strong>ExtentReports Integration</strong><br>
                        Add professional HTML reporting to Cucumber BDD scenarios
                    </div>
                </div>
                <div class="objective-item">
                    <i class="bi bi-check-circle objective-icon"></i>
                    <div>
                        <strong>Rich Dashboard Analytics</strong><br>
                        Generate charts, statistics, and visual test summaries
                    </div>
                </div>
                <div class="objective-item">
                    <i class="bi bi-check-circle objective-icon"></i>
                    <div>
                        <strong>Screenshot Integration</strong><br>
                        Automatically capture and attach visual evidence to reports
                    </div>
                </div>
                <div class="objective-item">
                    <i class="bi bi-check-circle objective-icon"></i>
                    <div>
                        <strong>Enhanced Step Reporting</strong><br>
                        Detailed logging and reporting for each Cucumber step
                    </div>
                </div>
            </div>
        </div>

        <!-- Building on Cucumber BDD -->
        <div class="content-section">
            <h2 class="section-title">
                <div class="section-icon"><i class="bi bi-diagram-3"></i></div>
                Building on Cucumber BDD Framework
            </h2>
            <div class="alert alert-info">
                <strong>Step 9 enhances Step 8's Cucumber BDD framework with professional reporting:</strong>
                <ul>
                    <li><strong>Existing Foundation:</strong> Gherkin scenarios and Step Definitions from Step 8</li>
                    <li><strong>New Layer:</strong> ExtentReports integration for beautiful HTML reports</li>
                    <li><strong>Enhanced Value:</strong> Visual evidence and analytics for stakeholders</li>
                    <li><strong>Same Tests, Better Presentation:</strong> Transform BDD results into executive-ready reports</li>
                </ul>
            </div>
        </div>

        <!-- ExtentReports Dependencies -->
        <div class="content-section">
            <h2 class="section-title">
                <div class="section-icon"><i class="bi bi-box"></i></div>
                Maven Dependencies
            </h2>
            <p>Add ExtentReports dependencies to your <code>pom.xml</code>:</p>

            <pre><code class="language-xml">&lt;dependencies&gt;
    &lt;!-- Existing dependencies from Step 8 (Cucumber, Selenium, etc.) --&gt;

    &lt;!-- NEW: ExtentReports Framework --&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;com.aventstack&lt;/groupId&gt;
        &lt;artifactId&gt;extentreports&lt;/artifactId&gt;
        &lt;version&gt;5.1.1&lt;/version&gt;
    &lt;/dependency&gt;

    &lt;dependency&gt;
        &lt;groupId&gt;tech.grasshopper&lt;/groupId&gt;
        &lt;artifactId&gt;extentreports-cucumber7-adapter&lt;/artifactId&gt;
        &lt;version&gt;1.14.0&lt;/version&gt;
    &lt;/dependency&gt;

    &lt;dependency&gt;
        &lt;groupId&gt;org.apache.commons&lt;/groupId&gt;
        &lt;artifactId&gt;commons-io&lt;/artifactId&gt;
        &lt;version&gt;1.3.2&lt;/version&gt;
    &lt;/dependency&gt;
&lt;/dependencies&gt;</code></pre>
        </div>

        <!-- ExtentReports Manager -->
        <div class="content-section">
            <h2 class="section-title">
                <div class="section-icon"><i class="bi bi-gear"></i></div>
                ExtentReports Manager
            </h2>
            <p>Create a centralized manager for ExtentReports configuration and operations:</p>

            <pre><code class="language-java">public class ExtentReportManager {
    private static ExtentReports extent;
    private static ExtentTest test;
    private static final String REPORT_PATH = "target/extent-reports/ExtentReport.html";
    private static final String SCREENSHOTS_PATH = "target/extent-reports/screenshots/";

    public static void initializeReport() {
        ExtentSparkReporter sparkReporter = new ExtentSparkReporter(REPORT_PATH);

        // Configure the report appearance
        sparkReporter.config().setTheme(Theme.STANDARD);
        sparkReporter.config().setDocumentTitle("QA Automation Test Report");
        sparkReporter.config().setReportName("Website Verification Test Results");
        sparkReporter.config().setTimeStampFormat("EEEE, MMMM dd, yyyy, hh:mm a '('zzz')'");

        extent = new ExtentReports();
        extent.attachReporter(sparkReporter);

        // Add system information to the report
        extent.setSystemInfo("Test Environment", "Development");
        extent.setSystemInfo("Browser", "Chrome (Headless)");
        extent.setSystemInfo("Operating System", System.getProperty("os.name"));
        extent.setSystemInfo("Java Version", System.getProperty("java.version"));
        extent.setSystemInfo("Test Framework", "Selenium + Cucumber + ExtentReports");
        extent.setSystemInfo("Execution Date", LocalDateTime.now().format(DateTimeFormatter.ofPattern("yyyy-MM-dd HH:mm:ss")));
    }

    public static ExtentTest createTest(String testName, String description) {
        test = extent.createTest(testName, description);
        return test;
    }

    public static void logInfo(String message) {
        if (test != null) {
            test.info(message);
        }
    }

    public static void logPass(String message) {
        if (test != null) {
            test.pass(message);
        }
    }

    public static void logFail(String message) {
        if (test != null) {
            test.fail(message);
        }
    }

    public static void captureScreenshot(WebDriver driver, String stepName) {
        if (test != null) {
            try {
                String screenshotPath = captureScreenshotAsFile(driver);
                test.addScreenCaptureFromPath(screenshotPath, stepName);
                test.info("Screenshot captured: " + stepName);
            } catch (IOException e) {
                test.fail("Failed to capture screenshot: " + e.getMessage());
            }
        }
    }

    public static void flushReport() {
        if (extent != null) {
            extent.flush();
            System.out.println("ExtentReports generated at: " + new File(REPORT_PATH).getAbsolutePath());
        }
    }
}</code></pre>
        </div>

        <!-- Enhanced Cucumber Steps -->
        <div class="content-section">
            <h2 class="section-title">
                <div class="section-icon"><i class="bi bi-code-square"></i></div>
                Enhanced Cucumber Steps with ExtentReports
            </h2>
            <p>Enhance your Step Definitions from Step 8 with ExtentReports logging:</p>

            <pre><code class="language-java">public class ExtentReportSteps {
    private WebDriver driver;
    private PageObjectManager pageManager;
    private JsonLinkDataReader dataReader;
    private List&lt;LinkData&gt; websites;
    private TestSummary testSummary;

    @Before
    public void setUp() {
        // Initialize ExtentReports
        ExtentReportManager.initializeReport();

        // Setup WebDriver (same as Step 8)
        WebDriverManager.chromedriver().setup();
        ChromeOptions options = new ChromeOptions();
        options.addArguments("--headless");
        options.addArguments("--no-sandbox");
        options.addArguments("--disable-dev-shm-usage");

        driver = new ChromeDriver(options);
        pageManager = new PageObjectManager(driver);
        dataReader = new JsonLinkDataReader();
        testSummary = new TestSummary();

        ExtentReportManager.logInfo("Test environment setup completed successfully");
    }

    @After
    public void tearDown() {
        if (driver != null) {
            driver.quit();
        }

        // Generate final report
        ExtentReportManager.flushReport();

        // Print test summary to console
        System.out.println("\\n" + testSummary.generateSummary());
    }

    @Given("I have a web browser available")
    public void i_have_a_web_browser_available() {
        ExtentReportManager.createTest("Browser Setup", "Verify web browser is available and configured");

        assertNotNull(driver, "WebDriver should be initialized");
        ExtentReportManager.logPass("Web browser initialized successfully");

        Logger.getInstance().logInfo("Browser setup completed successfully");
    }

    @Given("I navigate to the {string} website")
    public void i_navigate_to_website(String websiteName) {
        ExtentReportManager.createTest("Website Navigation - " + websiteName,
            "Navigate to " + websiteName + " and verify accessibility");

        try {
            websites = dataReader.readLinkData("java_project/data/links.json");
            LinkData targetSite = websites.stream()
                .filter(site -> site.getName().equals(websiteName))
                .findFirst()
                .orElseThrow(() -> new RuntimeException("Website not found: " + websiteName));

            ExtentReportManager.logWebsiteInfo(targetSite);
            ExtentReportManager.logInfo("Navigating to: " + targetSite.getUrl());

            driver.get(targetSite.getUrl());
            ExtentReportManager.captureScreenshot(driver, "Website loaded - " + websiteName);
            ExtentReportManager.logPass("Successfully navigated to " + websiteName);

            Logger.getInstance().logLinkOpened(targetSite.getUrl());

        } catch (Exception e) {
            ExtentReportManager.logFail("Failed to navigate to " + websiteName + ": " + e.getMessage());
            ExtentReportManager.captureScreenshot(driver, "Navigation failure - " + websiteName);
            fail("Failed to navigate to " + websiteName + ": " + e.getMessage());
        }
    }

    @When("the page loads completely")
    public void the_page_loads_completely() {
        ExtentReportManager.logInfo("Waiting for page to load completely");

        try {
            Thread.sleep(2000); // Simple wait - in real projects use WebDriverWait
            assertTrue(driver.getTitle().length() > 0, "Page should have a title");

            ExtentReportManager.logPass("Page loaded successfully");
            ExtentReportManager.logInfo("Page title: " + driver.getTitle());

            Logger.getInstance().logInfo("Page loaded successfully");
        } catch (InterruptedException e) {
            Thread.currentThread().interrupt();
            ExtentReportManager.logFail("Interrupted while waiting for page to load");
            fail("Interrupted while waiting for page to load");
        }
    }

    @Then("the page title should contain {string}")
    public void the_page_title_should_contain(String expectedTitle) {
        String actualTitle = driver.getTitle();
        ExtentReportManager.logInfo("Verifying page title contains: " + expectedTitle);
        ExtentReportManager.logInfo("Actual page title: " + actualTitle);

        boolean titleMatches = actualTitle.contains(expectedTitle);

        if (titleMatches) {
            ExtentReportManager.logPass("Title verification passed");
        } else {
            ExtentReportManager.logFail("Title verification failed - Expected: '" + expectedTitle + "', Actual: '" + actualTitle + "'");
            ExtentReportManager.captureScreenshot(driver, "Title verification failure");
        }

        assertTrue(titleMatches,
            "Expected title to contain '" + expectedTitle + "' but was '" + actualTitle + "'");

        Logger.getInstance().logInfo("Title verification passed: " + actualTitle);
    }
}</code></pre>
        </div>

        <!-- Cucumber Test Runner Configuration -->
        <div class="content-section">
            <h2 class="section-title">
                <div class="section-icon"><i class="bi bi-play-circle"></i></div>
                Updated Cucumber Test Runner
            </h2>
            <p>Update your test runner to include ExtentReports plugin:</p>

            <pre><code class="language-java">@Suite
@IncludeEngines("cucumber")
@SelectClasspathResource("features")
@ConfigurationParameter(key = "cucumber.plugin", value = "pretty,html:target/cucumber-reports,tech.grasshopper.ExtentCucumberAdapter:")
@ConfigurationParameter(key = "cucumber.glue", value = "com.example.app")
@ConfigurationParameter(key = "cucumber.features", value = "src/test/resources/features")
public class CucumberTestRunner {
    // This class serves as the entry point for running Cucumber tests with ExtentReports
    // All configuration is done via annotations above
    // ExtentReports will be automatically generated alongside Cucumber reports
}</code></pre>
        </div>

        <!-- Project Structure -->
        <div class="content-section">
            <h2 class="section-title">
                <div class="section-icon"><i class="bi bi-folder"></i></div>
                Updated Project Structure
            </h2>
            <div class="alert-box alert-info">
                <i class="bi bi-info-circle alert-icon"></i>
                <div>
                    <strong>ExtentReports Integration:</strong> We'll enhance our Cucumber BDD framework with professional HTML reporting and visual evidence capture.
                </div>
            </div>
            <div class="file-structure">
                <ul class="file-tree">
                    <li><span class="folder">üìÅ java_project/</span>
                        <ul>
                            <li><span class="folder">üìÅ src/</span>
                                <ul>
                                    <li><span class="folder">üìÅ main/java/com/example/app/</span>
                                        <ul>
                                            <li><span class="java-file">‚òï Main.java</span></li>
                                            <li><span class="java-file">üìä ExtentReportManager.java (NEW)</span></li>
                                            <li><span class="java-file">üìÑ BasePage.java</span></li>
                                            <li><span class="java-file">üìÑ GitHubHomePage.java</span></li>
                                            <li><span class="java-file">üìÑ JUnitHomePage.java</span></li>
                                            <li><span class="java-file">üìÑ MavenHomePage.java</span></li>
                                            <li><span class="java-file">üìÑ SeleniumHomePage.java</span></li>
                                            <li><span class="java-file">üìÑ PageObjectManager.java</span></li>
                                            <li><span class="java-file">üìÑ JsonLinkDataReader.java</span></li>
                                            <li><span class="java-file">üìÑ LinkData.java</span></li>
                                            <li><span class="java-file">üìÑ TestResult.java</span></li>
                                            <li><span class="java-file">üìÑ TestSummary.java</span></li>
                                            <li><span class="java-file">üìÑ Logger.java</span></li>
                                        </ul>
                                    </li>
                                    <li><span class="folder">üìÅ test/java/com/example/app/</span>
                                        <ul>
                                            <li><span class="java-file">ü•í CucumberTestRunner.java (Updated)</span></li>
                                            <li><span class="java-file">üìä ExtentReportSteps.java (NEW)</span></li>
                                        </ul>
                                    </li>
                                    <li><span class="folder">üìÅ test/resources/features/</span>
                                        <ul>
                                            <li><span class="feature-file">ü•í website-verification.feature</span></li>
                                        </ul>
                                    </li>
                                </ul>
                            </li>
                            <li><span class="folder">üìÅ target/extent-reports/ (auto-generated)</span>
                                <ul>
                                    <li><span class="html-file">üìä ExtentReport.html</span></li>
                                    <li><span class="folder">üìÅ screenshots/</span></li>
                                </ul>
                            </li>
                            <li><span class="folder">üìÅ data/</span>
                                <ul>
                                    <li><span class="json-file">üìÑ links.json</span></li>
                                </ul>
                            </li>
                            <li><span class="folder">üìÅ lib/</span>
                                <ul>
                                    <li><span class="jar-file">üì¶ selenium-java.jar</span></li>
                                    <li><span class="jar-file">ü•í cucumber-java.jar</span></li>
                                    <li><span class="jar-file">üìä extentreports.jar (NEW)</span></li>
                                </ul>
                            </li>
                            <li><span class="xml-file">‚öôÔ∏è pom.xml (Updated with ExtentReports)</span></li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>

        <!-- Running Tests with ExtentReports -->
        <div class="content-section">
            <h2 class="section-title">
                <div class="section-icon"><i class="bi bi-terminal"></i></div>
                Running Tests with ExtentReports
            </h2>
            <p>Execute your enhanced Cucumber scenarios with beautiful reporting:</p>

            <div class="terminal-output">
                <div class="terminal-header">
                    <div class="terminal-title">Maven Execution with ExtentReports</div>
                </div>
                <pre><code># Run all tests with ExtentReports
mvn test

# Run specific tagged scenarios with reporting
mvn test -Dcucumber.filter.tags="@smoke"

# Clean run with fresh reports
mvn clean test

# View generated reports
# HTML Report: target/extent-reports/ExtentReport.html
# Cucumber Report: target/cucumber-reports/index.html</code></pre>
            </div>

            <div class="alert alert-success">
                <strong>ExtentReports Benefits:</strong>
                <ul>
                    <li><strong>Visual Evidence:</strong> Screenshots automatically attached to each test step</li>
                    <li><strong>Rich Analytics:</strong> Charts, graphs, and statistics for test execution</li>
                    <li><strong>Stakeholder Friendly:</strong> Beautiful HTML reports for management review</li>
                    <li><strong>Historical Tracking:</strong> Compare test results across different executions</li>
                    <li><strong>Detailed Logging:</strong> Step-by-step execution details with timestamps</li>
                </ul>
            </div>
        </div>

        <!-- Sample Report Features -->
        <div class="content-section">
            <h2 class="section-title">
                <div class="section-icon"><i class="bi bi-bar-chart"></i></div>
                ExtentReports Dashboard Features
            </h2>
            <p>Your generated reports will include:</p>

            <div class="alert alert-info">
                <strong>Professional Report Components:</strong>
                <ul>
                    <li><strong>Executive Dashboard:</strong> High-level test statistics and pass/fail rates</li>
                    <li><strong>Test Details:</strong> Individual scenario results with step-by-step execution</li>
                    <li><strong>Screenshots Gallery:</strong> Visual evidence for every test action</li>
                    <li><strong>Timeline View:</strong> Chronological execution with duration metrics</li>
                    <li><strong>System Information:</strong> Environment details and configuration</li>
                    <li><strong>Error Analysis:</strong> Detailed failure information with stack traces</li>
                    <li><strong>Tag-based Filtering:</strong> Filter results by @smoke, @regression tags</li>
                </ul>
            </div>
        </div>

        <!-- Key Achievements -->
        <div class="content-section">
            <h2 class="section-title">
                <div class="section-icon"><i class="bi bi-trophy"></i></div>
                Step 9 Achievements
            </h2>
            <div class="alert alert-success">
                <strong>What You've Accomplished:</strong>
                <ul>
                    <li><strong>Professional Reporting:</strong> Added ExtentReports to Cucumber BDD framework</li>
                    <li><strong>Visual Documentation:</strong> Automatic screenshot capture for every test step</li>
                    <li><strong>Rich Analytics:</strong> Dashboard with charts, statistics, and trends</li>
                    <li><strong>Enhanced Step Definitions:</strong> Detailed logging integrated with BDD scenarios</li>
                    <li><strong>Stakeholder Communication:</strong> Executive-ready reports for business teams</li>
                    <li><strong>Complete Framework:</strong> End-to-end automation with professional presentation</li>
                </ul>
            </div>
        </div>

        <!-- Course Completion -->
        <div class="content-section">
            <h2 class="section-title">
                <div class="section-icon"><i class="bi bi-award"></i></div>
                üéì Course Complete - Enterprise QA Framework Achieved!
            </h2>
            <div class="alert alert-success">
                <strong>Congratulations! You've built a complete enterprise-ready QA automation framework:</strong>
                <ul>
                    <li>‚úÖ <strong>Professional Page Object Model</strong> architecture (Step 7)</li>
                    <li>‚úÖ <strong>Business-Readable BDD</strong> scenarios with Cucumber (Step 8)</li>
                    <li>‚úÖ <strong>Beautiful HTML Reports</strong> with ExtentReports (Step 9)</li>
                    <li>‚úÖ <strong>Selenium WebDriver</strong> browser automation (Steps 6-9)</li>
                    <li>‚úÖ <strong>Maven Build Management</strong> and dependency handling (All steps)</li>
                    <li>‚úÖ <strong>Screenshot Evidence</strong> and visual test documentation (Steps 7-9)</li>
                    <li>‚úÖ <strong>Clean Code Architecture</strong> following industry best practices (All steps)</li>
                </ul>
            </div>

            <div class="alert alert-info">
                <strong>üöÄ Career Ready Skills:</strong>
                <p>You now possess the exact skills that enterprise QA teams need. This framework demonstrates proficiency in:</p>
                <ul>
                    <li><strong>Test Automation:</strong> Selenium WebDriver with Page Object Model</li>
                    <li><strong>BDD Practices:</strong> Cucumber scenarios bridging business and technical teams</li>
                    <li><strong>Professional Reporting:</strong> ExtentReports for stakeholder communication</li>
                    <li><strong>Java Development:</strong> Clean, maintainable code following best practices</li>
                    <li><strong>Framework Design:</strong> Scalable architecture for enterprise testing</li>
                </ul>
                <p><strong>Perfect for QA Automation Engineer, SDET, and Test Automation Specialist roles!</strong></p>
            </div>
        </div>

        <!-- Next Step Preview -->
        <div class="content-section">
            <h2 class="section-title">
                <div class="section-icon"><i class="bi bi-arrow-right-circle"></i></div>
                Coming Next: Professional Logging with Log4j
            </h2>

            <div class="alert-box alert-info">
                <i class="bi bi-info-circle alert-icon"></i>
                <div>
                    <strong>Final Touch: Enterprise-Grade Logging</strong><br>
                    Our test framework now has comprehensive BDD scenarios, beautiful HTML reports, and visual documentation. In <strong>Step 10</strong>, we'll complete our professional framework by replacing the custom logger from Step 4 with enterprise-grade <strong>Apache Log4j 2</strong>.
                    <ul style="margin-top: 10px; margin-bottom: 0;">
                        <li><strong>Multiple log levels:</strong> TRACE, DEBUG, INFO, WARN, ERROR for different situations</li>
                        <li><strong>Configuration files:</strong> Control logging behavior without changing code</li>
                        <li><strong>File appenders:</strong> Separate log files for different purposes</li>
                        <li><strong>Performance:</strong> Asynchronous logging for high-throughput applications</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Navigation Footer -->
        <div class="lesson-nav">
            <div class="nav-actions footer-nav">
                <a href="step8.html" class="nav-btn nav-btn-outline"><i class="bi bi-arrow-left"></i> Step 8: Cucumber BDD</a>
                <a href="step10.html" class="nav-btn nav-btn-primary">Step 10: Log4j <i class="bi bi-arrow-right"></i></a>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- highlight.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script>hljs.highlightAll();</script>
</body>
</html>